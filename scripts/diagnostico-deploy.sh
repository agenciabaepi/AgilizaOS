#!/bin/bash

echo "üîç DIAGN√ìSTICO DO DEPLOY - VPS"
echo "================================"
echo ""

echo "1Ô∏è‚É£ Verificando conectividade SSH..."
echo "Testando conex√£o com o VPS..."

echo ""
echo "2Ô∏è‚É£ Verificando estrutura do projeto no VPS..."
echo "Diret√≥rio: /opt/gestaoconsert"
echo "Arquivos esperados:"
echo "  - package.json"
echo "  - yarn.lock"
echo "  - Dockerfile"
echo "  - docker-compose.yml"
echo "  - .github/workflows/deploy.yml"

echo ""
echo "3Ô∏è‚É£ Comandos que devem ser executados no VPS:"
echo "  cd /opt/gestaoconsert"
echo "  git pull origin main"
echo "  yarn build"
echo "  docker-compose down"
echo "  docker-compose up -d"

echo ""
echo "4Ô∏è‚É£ Poss√≠veis problemas:"
echo "  ‚ùå Credenciais SSH inv√°lidas"
echo "  ‚ùå VPS inacess√≠vel"
echo "  ‚ùå Diret√≥rio /opt/gestaoconsert n√£o existe"
echo "  ‚ùå Permiss√µes insuficientes"
echo "  ‚ùå Docker n√£o instalado no VPS"
echo "  ‚ùå Yarn n√£o instalado no VPS"

echo ""
echo "5Ô∏è‚É£ Solu√ß√µes recomendadas:"
echo "  ‚úÖ Verificar secrets do GitHub Actions"
echo "  ‚úÖ Testar SSH manualmente"
echo "  ‚úÖ Verificar se o VPS est√° online"
echo "  ‚úÖ Instalar Docker no VPS"
echo "  ‚úÖ Instalar Yarn no VPS"
echo "  ‚úÖ Verificar permiss√µes do usu√°rio"

echo ""
echo "üìã Para debug manual no VPS:"
echo "  ssh usuario@vps-ip"
echo "  cd /opt/gestaoconsert"
echo "  ls -la"
echo "  git status"
echo "  docker --version"
echo "  yarn --version"
